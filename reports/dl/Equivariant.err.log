Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.13.11/x64/lib/python3.13/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
    ~~~~~~~~~^
        nb,
        ^^^
    ...<4 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/opt/hostedtoolcache/Python/3.13.11/x64/lib/python3.13/site-packages/nbclient/client.py", line 1323, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/opt/hostedtoolcache/Python/3.13.11/x64/lib/python3.13/site-packages/jupyter_core/utils/__init__.py", line 165, in wrapped
    return loop.run_until_complete(inner)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/opt/hostedtoolcache/Python/3.13.11/x64/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/opt/hostedtoolcache/Python/3.13.11/x64/lib/python3.13/site-packages/nbclient/client.py", line 709, in async_execute
    await self.async_execute_cell(
        cell, index, execution_count=self.code_cells_executed + 1
    )
  File "/opt/hostedtoolcache/Python/3.13.11/x64/lib/python3.13/site-packages/nbclient/client.py", line 1062, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/opt/hostedtoolcache/Python/3.13.11/x64/lib/python3.13/site-packages/nbclient/client.py", line 918, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
import numpy as np
from scipy.special import sph_harm


def cart2irreps(x, L):
    """
    input N x 3 points and number of irreps (L)
    output L x N x M(l)
    """
    # convert to spherical coords and then evaluate
    # in spherical harmonics to get irrep values
    N = x.shape[0]
    r = np.linalg.norm(x, axis=-1)
    azimuth = np.arctan2(x[:, 1], x[:, 0])
    polar = np.arccos(x[:, 2], r)
    f = []
    for l in range(L):
        fi = []
        for m in range(-l, l + 1):
            y = sph_harm(m, l, azimuth, polar)
            fi.append(y)
        fi = np.array(fi)
        f.append(fi.T)  # transpose so N (particles) is first axes
    return f


def print_irreps(f):
    for i in range(len(f)):
        if len(f[0].shape) == 3:
            print(f"irrep {i} ({f[i].shape[-1]} channels)")
        else:
            print(f"irrep {i} (no channels)")
        print(f[i])


points = np.random.rand(2, 3)
L = 3  # number of irreps
f = cart2irreps(points, L)
print_irreps(f)
------------------


[31m---------------------------------------------------------------------------[39m
[31mImportError[39m                               Traceback (most recent call last)
[36mCell[39m[36m [39m[32mIn[18][39m[32m, line 2[39m
[32m      1[39m [38;5;28;01mimport[39;00m[38;5;250m [39m[34;01mnumpy[39;00m[38;5;250m [39m[38;5;28;01mas[39;00m[38;5;250m [39m[34;01mnp[39;00m
[32m----> [39m[32m2[39m [38;5;28;01mfrom[39;00m[38;5;250m [39m[34;01mscipy[39;00m[34;01m.[39;00m[34;01mspecial[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m sph_harm
[32m      5[39m [38;5;28;01mdef[39;00m[38;5;250m [39m[34mcart2irreps[39m(x, L):
[32m      6[39m [38;5;250m    [39m[33;03m"""[39;00m
[32m      7[39m [33;03m    input N x 3 points and number of irreps (L)[39;00m
[32m      8[39m [33;03m    output L x N x M(l)[39;00m
[32m      9[39m [33;03m    """[39;00m

[31mImportError[39m: cannot import name 'sph_harm' from 'scipy.special' (/opt/hostedtoolcache/Python/3.13.11/x64/lib/python3.13/site-packages/scipy/special/__init__.py)

